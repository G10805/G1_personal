syntax = "proto3";

package net.nlinterceptor;

import "InterceptedSocket.proto";
import "HalStatus.proto";

option optimize_for = LITE_RUNTIME;

message IInterceptor
{
    message CreateSocketReq
    {
        int32 nlFamily = 1;
        int32 clientNlPid = 2;
        string clientName = 3;
    }

    message CreateSocketCfm
    {
        HalStatus status = 1;
        InterceptedSocket result = 2;
    }

    message CloseSocketReq
    {
        InterceptedSocket handle = 1;
    }

    message CloseSocketCfm
    {
        HalStatus status = 1;
    }

    message SubscribeGroupReq
    {
        InterceptedSocket handle = 1;
        int32 nlGroup = 2;
    }

    message SubscribeGroupCfm
    {
        HalStatus status = 1;
    }

    message UnsubscribeGroupReq
    {
        InterceptedSocket handle = 1;
        int32 nlGroup = 2;
    }

    message UnsubscribeGroupCfm
    {
        HalStatus status = 1;
    }

    int32 instanceId = 1;
}
